질문 (원본):
2025-10-29

질문: 노동자를 리팩토링하자
노동자는 작업을 진행할때 알맞은 팀원(company)의 문서를 읽고 진행한다.
이때 test-guidelines.md는 테스트팀원을 읽을때 참조하고 Checklist는 기능팀원 문서를 읽을때 참조하자. 그래서 노동자, 노동자집, 테스트팀원,기능팀원이 상호작용을 잘할수 있도록 리팩토링해줘.

답변:

# 노동자(Worker) 리팩토링 완료 ✅

## 📊 리팩토링 개요

노동자와 팀원들 간의 문서 참조 체계를 명확히 정리했습니다.

---

## 🔍 핵심 변경 사항

### 1. 문서 참조 체계 확립

**Before** (문서 참조 불명확):
```
Worker → Test Team (test-team.md만)
Worker → Feature Team (feature-team.md만)
```

**After** (명확한 참조 체계):
```
Worker → Test Team
         ├─ reads: company/test-team.md (가이드라인)
         └─ references: doc/test-guidelines.md (구조, vitest 설정)

Worker → Feature Team
         ├─ reads: company/feature-team.md (가이드라인)
         └─ references: doc/checklist.md (커밋 전 검증)
```

---

## 🔧 수정된 파일 및 내용

### 1. test-team.md (테스트팀원)

#### A. Reference Materials 섹션 업데이트

**Before:**
```markdown
## Reference Materials
- Existing Tests: src/__tests__/unit/*.spec.ts
- Memory: memoryHome.md
```

**After:**
```markdown
## Reference Materials
- Test Guidelines: doc/test-guidelines.md ⭐ (NEW)
  - Test structure, naming conventions, vitest configuration
- Existing Tests: src/__tests__/unit/*.spec.ts, hooks/*.spec.ts, components/*.spec.tsx
- Memory: memoryHome.md
```

→ **test-guidelines.md**를 명시적으로 참조하도록 추가

---

### 2. feature-team.md (기능팀원)

#### A. Reference Materials 섹션 업데이트

**Before:**
```markdown
## Reference Materials
- Existing Utils: src/utils/*.ts
- Memory Home: memoryHome.md
- Worker Home: toolsHome.md
```

**After:**
```markdown
## Reference Materials
- Pre-Commit Checklist: doc/checklist.md ⭐ (NEW)
  - CRLF, lint, test validation before commit
- Existing Utils: src/utils/*.ts
- Memory Home: memoryHome.md
- Worker Home: toolsHome.md
```

#### B. Function Creation Checklist - Validation Phase 업데이트

**Before:**
```markdown
## Validation Phase
- [ ] Tests Pass
- [ ] Type Check: npm run lint:tsc
- [ ] Lint: npm run lint:eslint
- [ ] Coverage: Function is tested
```

**After:**
```markdown
## Validation Phase
- [ ] Tests Pass
- [ ] Type Check: npm run lint:tsc
- [ ] Lint: npm run lint:eslint
- [ ] Coverage: Function is tested
- [ ] Pre-Commit Checklist: Review doc/checklist.md ⭐ (NEW)
  - CRLF vs LF line endings (use LF)
  - No linter errors
  - All tests passing
```

→ **checklist.md**를 커밋 전 검증 단계에 명시

---

### 3. tools.md (노동자)

#### A. Phase 2: Red (Failing Test) 업데이트

**Before:**
```markdown
3. Delegate to Test Team:
   - Reference: company/test-team.md
```

**After:**
```markdown
3. Delegate to Test Team:
   - Test Team Reads: company/test-team.md
   - Test Team References: doc/test-guidelines.md ⭐
     (structure, naming conventions, vitest setup)
```

#### B. Phase 3: Green (Minimal Implementation) 업데이트

**Before:**
```markdown
5. Delegate to Feature Team:
   - Reference: company/feature-team.md
```

**After:**
```markdown
5. Delegate to Feature Team:
   - Feature Team Reads: company/feature-team.md
   - Feature Team References: doc/checklist.md ⭐
     (CRLF, lint, tests before committing)
```

#### C. Integration Points 섹션 업데이트

**Before:**
```markdown
- Test Team: Delegates test writing
  - Reference: company/test-team.md

- Feature Team: Delegates implementation
  - Reference: company/feature-team.md
```

**After:**
```markdown
- Test Team: Delegates test writing
  - Test Team reads: company/test-team.md
  - Test Team references: doc/test-guidelines.md ⭐

- Feature Team: Delegates implementation
  - Feature Team reads: company/feature-team.md
  - Feature Team references: doc/checklist.md ⭐
```

#### D. Technical Coordination 섹션 완전 재구성 ⭐

**Before:** (간단한 4줄 설명)
```markdown
- Test Writing: Delegated to Test Team
- Implementation: Delegated to Feature Team
- Integration: Worker's direct responsibility
- Architecture: Worker's decision-making authority
```

**After:** (상세한 워크플로우)
```markdown
### Test Team Workflow
1. Worker delegates test writing task
2. Test Team reads company/test-team.md for approach
3. Test Team references doc/test-guidelines.md for:
   - Test file structure (.spec.ts vs .spec.tsx)
   - Naming conventions (Korean descriptions)
   - Vitest configuration and IDE plugin setup
4. Test Team delivers comprehensive tests

### Feature Team Workflow
1. Worker delegates implementation task with failing tests
2. Feature Team reads company/feature-team.md for patterns
3. Feature Team implements minimal code to pass tests
4. Feature Team references doc/checklist.md before committing:
   - Run git diff --check (CRLF validation)
   - Run npm run lint:tsc (TypeScript)
   - Run npm run lint:eslint (ESLint)
   - Run npm test -- --run (All tests)
5. Feature Team delivers clean, passing code

### Worker Integration Responsibility
- Worker integrates tests and code into hooks/components
- Worker verifies end-to-end functionality
- Worker ensures architectural consistency
```

→ **각 팀의 워크플로우를 단계별로 상세히 명시**

---

## 📋 최종 문서 참조 체계

### Worker (노동자)
```
tools.md (노동자 명세)
└─ Coordinates:
   ├─ Test Team → company/test-team.md
   └─ Feature Team → company/feature-team.md
```

### Test Team (테스트팀원)
```
company/test-team.md
├─ Reads (가이드라인):
│  - company/test-team.md
│
└─ References (구체적 참조):
   - doc/test-guidelines.md ⭐
     • Test file structure (.spec.ts vs .spec.tsx)
     • Naming conventions (Korean)
     • Vitest configuration
   - memoryHome.md (patterns)
```

### Feature Team (기능팀원)
```
company/feature-team.md
├─ Reads (가이드라인):
│  - company/feature-team.md
│
└─ References (구체적 참조):
   - doc/checklist.md ⭐
     • CRLF vs LF validation
     • Lint checks
     • Test execution
   - memoryHome.md (patterns)
   - toolsHome.md (conventions)
```

---

## 🎯 상호작용 흐름도

```
┌─────────────────────────────────────────────┐
│          Worker (노동자)                     │
│                                              │
│  1. Consult Memory                           │
│  2. Analyze Task                             │
└───────────────┬─────────────────────────────┘
                │
    ┌───────────┴───────────────┐
    │                           │
    ▼                           ▼
┌─────────────┐           ┌──────────────┐
│ Test Team   │           │ Feature Team │
│ (테스트팀원)│           │ (기능팀원)   │
└──────┬──────┘           └──────┬───────┘
       │                         │
       ▼                         ▼
  ┌────────────┐          ┌───────────────┐
  │test-team.md│          │feature-team.md│
  └────┬───────┘          └───────┬───────┘
       │                          │
       ▼                          ▼
  ┌─────────────────┐      ┌──────────────┐
  │test-guidelines  │      │checklist.md  │
  │  ✓ Test structure│      │  ✓ CRLF check│
  │  ✓ Naming        │      │  ✓ Lint      │
  │  ✓ Vitest setup  │      │  ✓ Tests     │
  └─────────────────┘      └──────────────┘
       │                          │
       └──────────┬───────────────┘
                  ▼
          ┌──────────────┐
          │    Worker    │
          │  (통합 & 검증)│
          └──────────────┘
```

---

## 💡 개선 효과

### 1. 명확한 역할 분리
**Before:**
- 팀원들이 어떤 문서를 참조해야 하는지 불명확
- 각 문서의 역할이 모호함

**After:**
- 테스트팀원: test-guidelines.md 참조
- 기능팀원: checklist.md 참조
- 각 문서의 역할이 명확함

### 2. 워크플로우 가시화
**Before:**
- Technical Coordination이 4줄로만 설명됨
- 팀원들의 구체적인 작업 단계 불명확

**After:**
- Test Team Workflow 4단계
- Feature Team Workflow 5단계
- Worker Integration Responsibility 3항목
- 각 단계에서 참조할 문서 명시

### 3. 품질 검증 강화
**Before:**
- Feature Team이 커밋 전 무엇을 확인해야 하는지 불명확
- Test Team이 테스트 구조를 어디서 확인하는지 불명확

**After:**
- Feature Team: checklist.md로 커밋 전 4가지 검증
- Test Team: test-guidelines.md로 구조, 네이밍, vitest 설정 확인

### 4. 참조 문서 목적 명확화

| 문서 | 대상 | 목적 | 내용 |
|------|------|------|------|
| test-team.md | 테스트팀원 | 테스트 작성 가이드 | AAA 패턴, 예시, 체크리스트 |
| test-guidelines.md | 테스트팀원 | 프로젝트 특정 규칙 | .spec.ts vs .spec.tsx, 한글 설명, vitest 설정 |
| feature-team.md | 기능팀원 | 함수 작성 가이드 | 네이밍, 순수성, JSDoc |
| checklist.md | 기능팀원 | 커밋 전 검증 | CRLF, lint, test 실행 |

---

## 📝 사용 시나리오

### 시나리오 1: 새로운 유틸 함수 구현

```
1. Worker: "generateRecurringEvents 함수를 구현하자"
   ↓
2. Worker → Test Team: "테스트 작성해"
   ↓
3. Test Team:
   - company/test-team.md 읽음 (AAA 패턴, 예시)
   - doc/test-guidelines.md 참조 (파일명: .spec.ts, 한글 설명)
   - 16개 테스트 작성
   ↓
4. Worker → Feature Team: "이 테스트를 통과하는 함수 구현해"
   ↓
5. Feature Team:
   - company/feature-team.md 읽음 (순수 함수, JSDoc)
   - 함수 구현
   - doc/checklist.md 참조:
     * git diff --check ✓
     * npm run lint:tsc ✓
     * npm run lint:eslint ✓
     * npm test -- --run ✓
   - 커밋
   ↓
6. Worker:
   - useEventOperations에 통합
   - End-to-end 테스트
   - Manager에게 전달
```

### 시나리오 2: CRLF 문제 예방

**Before (checklist.md 참조 없음):**
```
Feature Team 구현 → 커밋 → 수천 개 lint 오류 발생 → 수정 필요
```

**After (checklist.md 참조):**
```
Feature Team 구현 → doc/checklist.md 확인
→ git diff --check 실행 → CRLF 발견 → LF로 변경 → 커밋 ✓
```

### 시나리오 3: Vitest 설정 문제 예방

**Before (test-guidelines.md 참조 없음):**
```
Test Team 작성 → components/ 폴더에 .spec.ts 사용 (잘못됨)
→ IDE plugin 작동 안 함 → 디버깅 어려움
```

**After (test-guidelines.md 참조):**
```
Test Team 작성 → doc/test-guidelines.md 확인
→ components/ 폴더는 .spec.tsx 사용
→ include 패턴 확인 → IDE plugin 정상 작동 ✓
```

---

## 결론

**노동자, 테스트팀원, 기능팀원이 명확한 문서 참조 체계를 갖추게 되었습니다:**

1. ✅ **테스트팀원**: test-team.md (가이드) + test-guidelines.md (프로젝트 규칙)
2. ✅ **기능팀원**: feature-team.md (가이드) + checklist.md (커밋 전 검증)
3. ✅ **노동자**: 팀원들에게 명확한 지시 + 통합 책임
4. ✅ **워크플로우**: 각 단계에서 참조할 문서가 명시됨
5. ✅ **품질 보장**: 커밋 전 자동 검증으로 실수 방지

**더 효율적이고 체계적인 팀 협업이 가능해졌습니다!** 🎯

