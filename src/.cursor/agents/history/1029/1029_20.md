# 질문 (원본)
2025-10-29

질문: 진행해

---

# 답변:

## 작업 내용

PRD 문서 (`src/.cursor/agents/request/fix-overlap-dialog-bugs.md`)의 요구사항에 따라 겹침 다이얼로그 버그 수정을 완료했습니다.

### 구현 완료 사항

#### Bug 1: 겹침 다이얼로그 조건부 버튼 (반복+일반만 bypass 허용)

**파일 생성:**
- `src/utils/overlapBypassLogic.ts`
  - `hasRecurringNormalConflict()` 함수 구현
  - 반복 일정과 일반 일정이 겹칠 때만 `true` 반환 (XOR 로직)
  - 일반+일반, 반복+반복 겹침은 `false` 반환

**테스트 파일 생성:**
- `src/__tests__/unit/overlapBypassLogic.spec.ts`
  - 7개 테스트 케이스 작성 (전체 통과)
  - 일반+일반, 반복+일반, 반복+반복, 엣지 케이스 커버

**App.tsx 수정:**
- `allowBypass` state 추가
- `hasRecurringNormalConflict()` 함수 호출하여 bypass 가능 여부 판단
- Dialog 메시지를 조건부로 표시:
  - `allowBypass=true`: "반복 일정과 일반 일정이 겹칩니다. 계속 진행하시겠습니까?"
  - `allowBypass=false`: "다음 일정과 겹칩니다. 다른 시간을 선택해주세요."
- "계속 진행" 버튼을 조건부로 표시 (`{allowBypass && ...}`)

#### Bug 2: '계속 진행' 클릭 후 폼 리셋 추가

**App.tsx 수정:**
- "계속 진행" 버튼의 `onClick` 핸들러에 `resetForm()` 호출 추가
- `await saveEvent()` 후 폼을 리셋하여 사용자 경험 개선

### TDD 사이클

✅ **Red 단계**: 실패하는 테스트 작성 완료
✅ **Green 단계**: 최소 코드로 테스트 통과 완료
✅ **Refactor 단계**: 코드 품질 개선 완료

### 검증 결과

✅ **TypeScript 검증**: `npm run lint:tsc` 통과
✅ **ESLint 검증**: `npm run lint:eslint` 통과 (CRLF → LF 변환 완료)
✅ **단위 테스트**: `overlapBypassLogic.spec.ts` 7/7 통과

### 알려진 이슈

통합 테스트 3건 실패 (기존 이슈, 반복 일정 관련):
- `입력한 새로운 일정 정보에 맞춰 모든 필드가 이벤트 리스트에 정확히 저장된다`
- `주별 뷰 선택 후 해당 일자에 일정이 존재한다면 해당 일정이 정확히 표시된다`
- `월별 뷰에 일정이 정확히 표시되는지 확인한다`

**원인**: 반복 일정 생성으로 인해 동일한 제목의 일정이 여러 개 표시되어 `getByText()`가 실패
**영향**: 오늘 구현한 겹침 다이얼로그 로직과는 무관 (기존 앱 동작의 테스트 이슈)

### 다음 단계

Manager(관리자) 검토 대기 중입니다.

---

## 변경 파일 목록

### 신규 파일
1. `src/utils/overlapBypassLogic.ts` - Bypass 로직 유틸리티
2. `src/__tests__/unit/overlapBypassLogic.spec.ts` - 단위 테스트

### 수정 파일
1. `src/App.tsx` - Dialog 조건부 렌더링 및 폼 리셋 추가

