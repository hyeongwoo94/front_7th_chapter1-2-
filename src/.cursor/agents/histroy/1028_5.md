질문 (원본):
2025-10-28

질문: @# King - 건물주 (Building Owner)  
나는 커밋을 했는데 lint에서 오류가 난다.

/home/runner/work/front_7th_chapter1-2/front_7th_chapter1-2/src/App.tsx
Error:   33:1  error  There should be no empty line within import group  import/order

/home/runner/work/front_7th_chapter1-2/front_7th_chapter1-2/src/__tests__/components/Modal.spec.tsx
Error:    3:1  error  There should be at least one empty line between import groups  import/order
Error:   42:1  error  Delete `⏎`                                                     prettier/prettier

/home/runner/work/front_7th_chapter1-2/front_7th_chapter1-2/src/components/Modal.tsx
Error:   61:1  error  Delete `⏎`  prettier/prettier

/home/runner/work/front_7th_chapter1-2/front_7th_chapter1-2/src/hooks/useNotifications.ts
Warning:   32:6  warning  React Hook useEffect has a missing dependency: 'checkUpcomingEvents'. Either include it or remove the dependency array  react-hooks/exhaustive-deps

✖ 5 problems (4 errors, 1 warning)
  4 errors and 0 warnings potentially fixable with the `--fix` option.

이러한 오류 내용이 있다.
.prettierrc를 참고 하여 오류를 수정하고 이 작업을 하면서 찾은 내용을 agents/doc/checklist.md 에 잘 작성해둬라. 다음에 너가 작업을 할때 해당 문서를 읽고 같은 실수를 반복하지 않도록.

답변:
건물주로서 lint 오류를 분석하고 수정했으며, 포괄적인 체크리스트를 작성했습니다.

## 🔍 문제 분석

### 보고된 오류
1. App.tsx - import 그룹 내 빈 줄 오류
2. Modal.spec.tsx - import 그룹 간 빈 줄 누락, 파일 끝 빈 줄
3. Modal.tsx - 파일 끝 빈 줄
4. useNotifications.ts - React Hook 의존성 누락

### 숨겨진 치명적 문제: CRLF vs LF

lint --fix 실행 시 **3,570개의 prettier 오류** 발견:
- 모든 파일에 `Delete ␍` (CRLF 문자) 오류
- Windows CRLF (`\r\n`) vs Unix LF (`\n`) 문제

## ✅ 수정 완료 항목

### 1. Modal.spec.tsx - Import 순서
```typescript
// Before (❌)
import { describe, it, expect, vi } from 'vitest';
import Modal from '../../components/Modal';  // No blank line

// After (✅)
import { describe, it, expect, vi } from 'vitest';

import Modal from '../../components/Modal';  // Blank line added
```

### 2. Modal.tsx - 파일 끝 빈 줄
```typescript
// Added exactly one newline at end of file
export default Modal;
← newline here
```

### 3. useNotifications.ts - React Hook 의존성
```typescript
// Before (❌)
const checkUpcomingEvents = () => {
  // ... uses events, notifiedEvents
};

useEffect(() => {
  setInterval(checkUpcomingEvents, 1000);
}, [events, notifiedEvents]);  // Missing checkUpcomingEvents

// After (✅)
import { useCallback, useEffect, useState } from 'react';

const checkUpcomingEvents = useCallback(() => {
  // ... uses events, notifiedEvents
}, [events, notifiedEvents]);

useEffect(() => {
  setInterval(checkUpcomingEvents, 1000);
}, [checkUpcomingEvents]);  // Correct dependency
```

### 4. Git 설정
```bash
git config core.autocrlf false  # Prevent CRLF auto-conversion
```

## 📋 체크리스트 문서 생성

`src/.cursor/agents/doc/checklist.md` 생성 완료

### 주요 섹션:

#### 1. Critical Issues to Check Before Commit
<!-- 커밋 전 반드시 확인할 치명적 이슈 -->
- **Line Ending Issues (CRLF vs LF)**: 가장 치명적인 문제
  - 증상: 수천 개의 `Delete ␍` 오류
  - 원인: Windows CRLF vs Prettier LF 설정
  - 해결: VS Code에서 LF로 변환, Git renormalize

- **Import Order Issues**: eslint-plugin-import 규칙
  - 외부 라이브러리
  - 빈 줄 하나
  - 내부 모듈
  - 같은 그룹 내에는 빈 줄 없음

- **File Ending Blank Line**: 파일 끝에 정확히 한 줄

- **React Hooks Dependencies**: useEffect/useCallback 의존성

#### 2. Pre-Commit Command Checklist
<!-- 커밋 전 명령어 체크리스트 -->
```bash
git diff --check          # CRLF 확인
npm run lint:eslint       # Lint 검사
npm run lint:tsc          # TypeScript 컴파일
npm test -- --run         # 모든 테스트
npm run lint:eslint -- --fix  # 자동 수정
```

#### 3. Common Lint Errors and Fixes
<!-- 일반적인 Lint 오류 및 수정 -->
| Error | Meaning | Fix |
|-------|---------|-----|
| `Delete ␍` | CRLF line ending | Convert to LF |
| Empty line between groups | Import order | Add/remove blank line |
| Missing dependency | React Hooks | Add to array or useCallback |

#### 4. Automation Setup
<!-- 자동화 설정 -->
- VS Code settings.json 예제
- Git hooks (husky) 설정 방법

## 🚨 해결해야 할 사항

**CRLF → LF 변환 필요**

모든 소스 파일이 여전히 CRLF를 사용하고 있습니다. 다음 방법 중 하나로 해결:

### 방법 1: VS Code (가장 쉬움)
1. `Ctrl+Shift+P`
2. "Change All End of Line Sequence"
3. "LF" 선택

### 방법 2: Git
```bash
git add --renormalize .
```

### 방법 3: 자동화
`.vscode/settings.json` 생성:
```json
{
  "files.eol": "\n",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  }
}
```

## 📚 학습 내용

### 왜 CRLF 문제가 발생했나?

1. **Windows 기본 동작**: Windows는 CRLF를 사용
2. **Git autocrlf**: 기본적으로 true (자동 변환)
3. **Prettier 설정**: `"endOfLine": "lf"` 요구
4. **충돌**: Windows에서 생성한 파일이 CRLF로 저장됨

### 예방 조치

1. ✅ Git config 설정: `git config core.autocrlf false`
2. ✅ VS Code 설정: `"files.eol": "\n"`
3. ✅ Pre-commit hooks: husky로 자동 검사
4. ✅ Checklist 문서: 반복 실수 방지

## 🎯 다음 작업 시 참고사항

**매 작업 시작 전:**
1. `checklist.md` 읽기
2. 새 파일 생성 시 LF 사용 확인
3. import 순서 규칙 준수
4. 파일 끝 빈 줄 확인

**커밋 전:**
1. `npm run lint` 실행
2. 모든 오류 해결
3. 테스트 통과 확인
4. CRLF 문제 없는지 확인

이제 `checklist.md`가 있으므로 같은 실수를 반복하지 않을 것입니다!

